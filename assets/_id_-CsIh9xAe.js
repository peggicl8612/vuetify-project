import{a$ as k,H as I,u as q,a as w,G as F,K as $,av as x,aD as B,ax as E,ay as N,o as P,h as Q,d as a,w as t,ai as j,aj as p,E as i,t as o,z as A,x as D,az as M,j as n,aA as R,ak as z,e as O,f as T,V as U,b0 as G,F as H,C as f,I as K}from"./index-BTPGj9ac.js";const L={class:"text-center"},J={class:"text-center"},W={__name:"[id]",setup(X){const{api:b,apiAuth:V}=K(),h=k(),m=I(),{t:s}=q(),g=w(),y=F(),u=$({_id:"",name:"",price:0,description:"",image:"",sell:!0,breed:""});(async()=>{try{const{data:e}=await b.get("/product/"+h.params.id);u.value=e.result,document.title=u.value.name+" | 咪凹屋"}catch(e){console.log(e),m.push("/")}})();const _=x({quantity:B().typeError(s("product.addCartQuantityInvalid")).required(s("product.addCartQuantityInvalid")).positive(s("product.addCartQuantityInvalid")).integer(s("product.addCartQuantityInvalid"))}),{handleSubmit:C,isSubmitting:v}=E({validationSchema:_,initialValues:{quantity:1}}),c=N("quantity"),S=C(async e=>{var l,d;if(!g.isLoggedIn){m.push("/login");return}try{const{data:r}=await V.patch("/user/cart",{cat:u.value._id,quantity:e.quantity});g.cart=r.result,y({text:s("product.addCartSuccess"),snackbarProps:{color:"green"}})}catch(r){console.log(r),y({text:s("api."+(((d=(l=r==null?void 0:r.response)==null?void 0:l.data)==null?void 0:d.message)||"unknownError")),snackbarProps:{color:"red"}})}});return(e,l)=>(P(),Q(H,null,[a(U,null,{default:t(()=>[a(j,null,{default:t(()=>[a(p,{cols:"12"},{default:t(()=>[i("h1",L,o(u.value.name),1)]),_:1}),a(A),a(p,{cols:"12",md:"6"},{default:t(()=>[a(D,{src:e.product.image},null,8,["src"])]),_:1}),a(p,{cols:"12",md:"6"},{default:t(()=>[i("p",null,o(e.$t("catBreed."+u.value.breed)),1),i("p",null,o(e.product.price),1),i("p",null,o(e.product.description),1),a(M,{disabled:n(v),onSubmit:R(n(S),["prevent"])},{default:t(()=>[a(z,{modelValue:n(c).value.value,"onUpdate:modelValue":l[0]||(l[0]=d=>n(c).value.value=d),modelModifiers:{number:!0},type:"number","error-messages":n(c).errorMessage.value},null,8,["modelValue","error-messages"]),a(O,{type:"submit","prepend-icon":"mdi-cart",loading:n(v)},{default:t(()=>[T(o(e.$t("product.addCart")),1)]),_:1},8,["loading"])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}),a(G,{"model-value":!e.product.sell,class:"align-center justify-center",scrim:"black",opacity:"0.8",persistent:""},{default:t(()=>[i("h1",J,o(e.$t("api.productNotOnSell")),1)]),_:1},8,["model-value"])],64))}};typeof f=="function"&&f(W);export{W as default};
