import{a as $,H as q,G as z,u as A,K as L,c as g,o as n,b as m,w as s,d as a,ai as S,aj as i,E as y,t as u,z as V,q as D,h as C,F as b,i as F,s as P,v as R,x as j,e as p,f as w,k as G,V as H,C as x,I as K}from"./index-COzN7fec.js";const T={class:"text-center"},U={__name:"cart",setup(J){const{apiAuth:d}=K(),k=$(),B=q(),_=z(),{t:v}=A(),o=L([]),f=async()=>{try{const{data:t}=await d.get("/user/cart");o.value=t.result}catch(t){console.log(t)}};f();const E=g(()=>o.value.reduce((t,c)=>t+c.product.price*c.quantity,0)),I=g(()=>o.value.length>0&&o.value.every(t=>t.product.sell)),h=async(t,c)=>{var e,l;try{const{data:r}=await d.patch("/user/cart",{product:t,quantity:c});k.cart=r.result,f()}catch(r){console.log(r),_({text:v("api."+(((l=(e=r==null?void 0:r.response)==null?void 0:e.data)==null?void 0:l.message)||"unknownError")),snackbarProps:{color:"red"}})}},N=async()=>{var t,c;try{await d.post("/order"),k.cart=0,B.push("/orders")}catch(e){console.log(e),_({text:v("api."+(((c=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:c.message)||"unknownError")),snackbarProps:{color:"red"}})}};return(t,c)=>(n(),m(H,null,{default:s(()=>[a(S,null,{default:s(()=>[a(i,{cols:"12"},{default:s(()=>[y("h1",T,u(t.$t("nav.cart")),1)]),_:1}),a(V),a(i,{cols:"12"},{default:s(()=>[a(D,{lines:"two"},{default:s(()=>[(n(!0),C(b,null,F(o.value,(e,l)=>(n(),C(b,{key:e._id},[a(P,{title:e.product.name,subtitle:e.product.price,"active-class":"bg-red",active:!e.product.sell},{prepend:s(()=>[a(R,{rounded:"0"},{default:s(()=>[a(j,{src:e.product.image},null,8,["src"])]),_:2},1024)]),append:s(()=>[a(p,{color:"red",icon:"mdi-minus",size:"small",class:"mr-2",onClick:r=>h(e.product._id,-1)},null,8,["onClick"]),w(" "+u(e.quantity)+" ",1),a(p,{color:"green",icon:"mdi-plus",size:"small",class:"ml-2",onClick:r=>h(e.product._id,1)},null,8,["onClick"])]),_:2},1032,["title","subtitle","active"]),l<o.value.length-1?(n(),m(V,{key:0})):G("",!0)],64))),128))]),_:1})]),_:1}),a(i,{cols:"12",class:"text-center"},{default:s(()=>[y("p",null,u(E.value),1),a(p,{color:"primary",disabled:!I.value,onClick:N},{default:s(()=>[w(u(t.$t("cart.checkout")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}))}};typeof x=="function"&&x(U);export{U as default};
